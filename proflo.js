setTimeout(() => {
  const identifiers = document.querySelector("#drawing-frame").contentWindow.document.querySelectorAll("div");
  const rightContent = document.querySelector(".content-right")

  identifiers.forEach(identifier => {
    if (identifier.textContent.substring(0,2) == "AS") {
      var streamDiv = identifier;
      identifier.addEventListener('mouseover', () => {
        showInfo(identifier, rightContent);
      });
      identifier.addEventListener('mouseout', () => {
        hideInfo(streamDiv, rightContent);
      });
      identifier.addEventListener('click', () => {
        identifier.removeEventListener('mouseOut', () => {
          hideInfo(streamDiv, rightContent);
        });
        showInfo(identifier, rightContent);
      });
    };
  });

}, 100);

function showInfo(streamDiv, rightContent) {
  streamDiv.style.backgroundColor = "red";
  streamDiv.style.cursor = "pointer";
  let position = streamDiv.getBoundingClientRect();
  const streamInfo = document.createElement("div");
  streamInfo.classList.add('stream-info');
  streamInfo.style.left = `${position.left + position.width}px`
  streamInfo.style.top = `${position.top + position.height}px`
  rightContent.appendChild(streamInfo);
  buildTable(streamInfo, streamDiv);
}

function hideInfo(streamDiv, rightContent) {
  streamDiv.style.background = "none";
  streamInfo = document.querySelector(".stream-info");
  streamInfo.remove();
}

function buildTable(streamInfo, streamDiv) {
  const stHeading = document.createElement("h2");
  stHeading.classList.add("streaminfo-title")
  stHeading.textContent = "Stream Information";
  streamInfo.appendChild(stHeading);

  const table = document.createElement("table");
  table.classList.add("stream-table")
  streamInfo.appendChild(table);

  for (let row = 0; row < stream_data.length; row++) {
    const rowElement = document.createElement("tr");
    rowElement.classList.add("table-cell");
    table.appendChild(rowElement);
    for (let col = 0; col < 2; col++) {
      const cellElement = document.createElement("td");
      cellElement.classList.add("table-cell");
      if (col == 0) {
        cellElement.textContent = stream_data[row][0];
      } else {
        cellElement.textContent = stream_data[row][stream_data[0].indexOf(streamDiv.textContent)];
      }
      rowElement.appendChild(cellElement);
    };
  };
};

let stream_data = [['Parameter',
  'AS-001',
  'AS-002',
  'AS-003',
  'AS-004',
  'AS-005',
  'AS-006',
  'AS-002',
  'AS-008',
  'AS-019',
  'AS-009',
  'AS-010',
  'AS-011',
  'AS-012',
  'AS-013',
  'AS-014',
  'AS-015'],
 ['Acetone ',
  2.552e-06,
  0.0,
  0.0,
  0.0,
  2.8102668030948514e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Methanol ',
  7.348e-05,
  0.0,
  0.0,
  0.0,
  8.091630277876556e-06,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Ethanol ',
  1.408e-06,
  0.0,
  0.0,
  0.0,
  1.5504920292937113e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Acetic Acid ',
  1.1792e-05,
  0.0,
  0.0,
  0.0,
  1.2985370745334831e-06,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Formic Acid ',
  3.96e-06,
  0.0,
  0.0,
  0.0,
  4.3607588323885627e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Terpenes/Pinenes ',
  0.00013816,
  0.0,
  0.0,
  0.0,
  1.521420303744454e-05,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Formaldehyde ',
  5.367999999999999e-06,
  0.0,
  0.0,
  0.0,
  5.911250861682274e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Acetaldehyde ',
  1.408e-06,
  0.0,
  0.0,
  0.0,
  1.5504920292937113e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['propionaldehyde ',
  1.056e-06,
  0.0,
  0.0,
  0.0,
  1.1628690219702834e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['acrolein ',
  9.68e-07,
  0.0,
  0.0,
  0.0,
  1.0659632701394266e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Fatty Acids',
  4.3999999999999997e-07,
  0.0,
  0.0,
  0.0,
  4.8452875915428476e-08,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Resin Acids',
  1.056e-06,
  0.0,
  0.0,
  0.0,
  1.1628690219702834e-07,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Lignin',
  0.2288,
  0.0,
  0.0,
  0.012796333555136449,
  0.0,
  0.2586059811747885,
  0.0,
  1.0,
  0.0,
  0.013450661731170524,
  0.0,
  0.018983738004321987,
  0.0,
  0.02747789019043717,
  0.0,
  0.08607430650275551],
 ['Cellulose ',
  0.3696,
  0.0,
  0.0,
  0.0,
  0.0,
  0.4227522935779816,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Galactoglucomannan',
  0.132,
  0.0,
  0.0,
  0.014272833580729116,
  0.0,
  0.2884451328488026,
  0.0,
  0.0,
  0.02052686953065101,
  0.015002661161690198,
  0.0,
  0.021174169312512984,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Arabinoglucuroxylan ',
  0.088,
  0.0,
  0.0,
  0,
  0.0,
  0,
  0.0,
  0.0,
  0,
  0,
  0.0,
  0,
  0,
  0,
  0.0,
  0.0],
 ['Arabinogalactan',
  0.0352,
  0.0,
  0.0,
  0,
  0.0,
  0,
  0.0,
  0.0,
  0,
  0,
  0.0,
  0,
  0,
  0,
  0.0,
  0.0],
 ['Uronic acids etc',
  0.0264,
  0.0,
  0.0,
  0.0,
  0.0,
  0.03019659239842726,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0,
  0.0],
 ['Water',
  0.12,
  1.0,
  1.0,
  0.9729308328641345,
  0.9999733896805473,
  0.0,
  1.0,
  0.0,
  0.979473130469349,
  0.9715466771071393,
  1.0,
  0.9598420926831651,
  1.0,
  0.9725221098095628,
  1.0,
  0.9139256934972446],
 ['Total:',
  1.0002416479999998,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0,
  1.0000000000000002],
 ['Stream mass flow mg/kg OD',
  1136638.2363636363,
  10416666.666666668,
  10416666.666666668,
  240510.41666666663,
  10319304.903030304,
  993489.5833333334,
  76248.89999999998,
  3077.651515151515,
  167232.7651515151,
  228810.41666666663,
  11700.0,
  162120.41666666663,
  66689.99999999999,
  112004.65151515149,
  46682.99999999999,
  35755.7515151515],
 ['Stream mass flow mg/kg Pine',
  1000241.6479999999,
  9166666.666666668,
  9166666.666666668,
  211649.16666666663,
  9080988.314666668,
  874270.8333333334,
  67099.03199999998,
  2708.333333333333,
  147164.83333333328,
  201353.16666666663,
  10296.0,
  142665.96666666665,
  58687.19999999999,
  98564.09333333331,
  41081.03999999999,
  31465.061333333324],
 ['Stream mass flow mg/annum',
  160038663680000.0,
  1466666666666666.8,
  1466666666666666.8,
  33863866666666.66,
  1452958130346667.0,
  139883333333333.34,
  10735845119999.996,
  433333333333.3333,
  23546373333333.324,
  32216506666666.66,
  1647360000000.0,
  22826554666666.664,
  9389951999999.998,
  15770254933333.33,
  6572966399999.999,
  5034409813333.332],
 ['Stream mass flow tonne/annum',
  160038.66368,
  1466666.6666666667,
  1466666.6666666667,
  33863.86666666666,
  1452958.130346667,
  139883.33333333334,
  10735.845119999996,
  433.3333333333333,
  23546.373333333326,
  32216.50666666666,
  1647.36,
  22826.554666666663,
  9389.951999999997,
  15770.25493333333,
  6572.966399999999,
  5034.409813333332],
 ['Stream mass flow tonne/day',
  438.4620922739726,
  4018.2648401826486,
  4018.2648401826486,
  92.77771689497716,
  3980.7072064292247,
  383.2420091324201,
  29.413274301369853,
  1.187214611872146,
  64.5106118721461,
  88.264401826484,
  4.51331506849315,
  62.53850593607305,
  25.725895890410953,
  43.20617789954337,
  18.008127123287668,
  13.792903598173512]]